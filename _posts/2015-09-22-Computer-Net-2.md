---
layout: post
title: 计算机网络体系结构
categories: 计算机网络 笔记
date: 2015-09-22 13:46:01
---
<!-- more -->
## 计算机网络的基本功能
为地理位置不同的计算机用户之间提供访问通路

* 实现信息交互必需功能
    * 连接性
        * 物理传输通路，可经过中间节点
        * 二进制通信
        * 多用户共享同一条物理线路
    * 可标识、可定位
        * 地址分配
        * 按照地址路由选择
    * 正确性
        * 无差错
        * 缓冲和流量控制
    * 其他
        * 会话控制，满足各种要求

## 计算机网络体系结构
* 对计算机网络及其部件所完成功能的比较精确的定义
* 从 *功能* 的角度描述计算机网络的结构
* 是 *层次和层间关系* 的集合

只定义协议应当完成的功能，不定义实现细节和接口关系

### 体系结构特点
* 通信的计算机之间同时满足要求
* 通信双向，功能是相互的
* 功能分布在用户设备（计算机）和网络设备（交换结点）中

### 功能是分成层次的
* 同层之间：协议
    * 同等层次之间通信双方进行信息交换时必须遵守的规则
* 不同层次之间：服务
    * 层间交换信息时必须遵守的规则
        * 上层服务用户，下层服务提供者
* 为什么要分层
    * 若不分层，不同应用在不同传输介质上都要开发独立程序
    * 解决办法，开发一个中间件，屏蔽特点
* 分层的优点
    * 模块化：易于开发管理维护
    * 独立性
    * 复用性
    * 标准化
* 分层的缺点
    * 低效：信息屏蔽导致性能优化困难

### 具体实现

#### 服务访问点SAP（Service Access Point）
* 任何层间服务都是在接口上的SAP进行的
* 每个SAP有唯一识别地址
* 每个层间接口可以有多个SAP

#### 接口数据单元IDU（Interface Data Unit）
* IDU是通过SAP进行传送的层间信息单元
* 由上层服务数据单元SDU和接口控制信息ICI组成

#### 协议数据单元PDU（Protocol Data Unit）
* 第N层实体通过网络传送给它的对等实体的信息单元
* 由上层的服务数据单元SDU或其分段和协议控制信息PCI组成
* 分段和重组
    * 分段降低误码率

过程：

* 发送：n+1层IDU(ICI|SDU)通过SAP进入第n层，第n层将SDU加上自己的Header变成第n层的PDU，将此PDU作为SDU往下传，最后在第二层加上校验经过第一层（物理信道）传输。
* 接收：每一层去掉当前层的Header继续往上传

### 服务
* 服务分类和服务原语（Primitives）
    * 基于连接的服务和无连接服务
        * 基于连接的服务
            * 首先建立连接，然后数据传送
            * 传送结束后关闭连接
            * 特点：顺序性好
        * 无连接服务
            * 直接使用服务传送数据，每个分组独立进行路由选择
            * 特点：顺序性差
        * 面向连接不等于传输的可靠性
    * 服务原语
        * 服务在形式上是由一组接口原语来描述的
        * 原语可携带参数
        * 可分为四种类型
            * 请求：一个实体希望得到完成某些操作的服务
            * 指示：通知一个实体有某个事件发生
            * 响应：希望响应一个时间
            * 确认：返回响应
        * 服务 
            * 有证实（四种类型都有）
            * 无证实（只有前两种类型）

### 端到端问题

* 高层和底层都可以实现的功能
    * 以高层实现为主
    * 实现底层的功能应保证尽可能小的影响那些不使用该功能的高层功能的性能
    * 提高性能的功能以底层实现为主

* 接收端必须检查传输正确性


### 计算机网络的标准化
* 电信标准 国际电信联盟ITU
* 国际标准 国际标准化组织ISO
* Internet标准 自发的
    * 称为RFC

#### ISO/OSI参考模型
* 七层：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

#### TCP/IP参考模型
以TCP/IP协议为核心的internet网络体系结构
* 应用层：提供各种Internet管理和应用服务
* 传输层：端到端的数据传输服务
* 互联网层/IP层：控制通信子网提供源点到目的点的分组传送
* 主机至网络层：物理层、数据链路层（TCP/IP协议没有进行明确的规定）

##### TCP/IP体系结构中的协议
* 应用层：远程登陆TELNET、文件传输FTP、电子邮件SMTP、域名服务DNS、网络管理SNMP * 
* 传输层：面向连接的传输控制协议TCP、无连接的用户数据报协议UDP
* 网络层：互联网协议IP、互联网控制消息协议ICMP、地址解析协议ARP、路由信息协议RIP
* 主机至网络层：数据链路层和物理层；以太网等等；ARPANET、SATNET、Packet radio、 LAN

##### 应用实例
* 流程：封装(各种协议控制信息(数据链路层包头14B，网络层包头20B，传输层包头32B)+数据)、解封装
* HTTP：客户端请求（Request），服务器应答
* 工具：Tcpdump(Windump)
    * `-D` 显示端口列表
    * `-i` 监听指定端口
    * `-w` 将分组内容保存到文件中
    * `-r` 从文件中读出保存的分组
    * `-s` 每个分组保存长度
    * `-x` 以十六进制方式显示分组内容
    * `<expression>` 匹配条件
    * 例如：`Tcpdump -i eth0 -s 200 -x -w tcpdump.pac host 59.66.30.10 and port 80
